
<div dir="rtl">

# چگونگی یافتن آیپی تمیز کلادفلر

بزرگترین ارائه دهنده خدمات CDN در جهان کلادفلر است و احتمالا می دانید؛ به دلیل فیلترینگ شدید اینترنت در ایران اختلال زیادی روی سرویس های آن وجود دارد زیرا امکان فیلتر نمودن کامل آن برای فیلترچی مقدور نیست اما می تواند روی آن اختلال ایجاد کند. 

در اینجا اگر شما نیز از سرویس های CDN کلادفلر استفاده می کنید؛ متاثر از این اختلالات خواهید شد. برای کاهش تاثیر این اختلالات می بایست آیپی های تمیز (آیپی هایی که اختلالی روی آن نیست) را پیدا کرد.

در اینجا چند راه کار برای این موضوع معرفی و بررسی می گردد.
نکته:
> قبل از شروع تاکید می شود تمامی این تست ها روی سیستم کلاینت و بدون اتصال به VPN باید انجام شوند.

## استفاده از اسکریپت آقای مرتضی باشسیز
آقای باشسیز یک مهندس ایرانی است که برنامه ای تحت عنوان CFScanner توسعه داده است که با استفاده از آن می توان لیست آیپی های کلادفلر را بر روی شبکه های مختلف تست نمود و به آیپی های تمیز کلادفلر رسید.

این برنامه در دو نسخه لینوکس و ویندوز منتشر شده است.
برای این کار در ابتدا از [اینجا](https://github.com/MortezaBashsiz/CFScanner) نسخه مدنظر خود را دانلود کنید و سپس نحوه اجرای آن را بر اساس سیستم عامل مورد نظر دنبال کنید.




### اجرا در نسخه لینوکس

فایل های برنامه را دانلود کنید و ابتدا توضیحات آقای باشسیز درباره نحوه اجرا را در ویدئوی زیر ببینید



[![Screenshot_2022-01-27_at_10 03 36](https://user-images.githubusercontent.com/125398461/222939631-2b73ef2c-813b-4a00-a6b5-13082002d487.png)](https://www.youtube.com/watch?v=BKLRAHolhvM)

این برنامه پیش نیازهایی دارد.
[jq](https://stedolan.github.io/jq/)
[git](https://git-scm.com/)
[tput](https://command-not-found.com/tput)
[bc](https://www.gnu.org/software/bc/)
[curl](https://curl.se/download.html)
[parallel](https://www.gnu.org/software/parallel/)

سپس ابتدا آن را با کد زیر روی سیستم خود clone کنید:
</div>

```
git clone https://github.com/MortezaBashsiz/CFScanner.git 
```


<div dir="rtl">

به آن دسترسی اجرا دهید.
</div>

```
cd CFScanner/bash
chmod +x ../bin/*
```

<div dir="rtl">

فایل config.real را دانلود کنید.

</div>

```
curl -s https://raw.githubusercontent.com/MortezaBashsiz/CFScanner/main/bash/ClientConfig.json -o config.real
```

<div dir="rtl">

توصیه می شود فایل config.real را بر اساس کانفیگ خود تغییر دهید.
</div>

![Screenshot_20230305_094935](https://user-images.githubusercontent.com/125398461/222945619-756a8a4c-9cd7-4977-8679-c5a3a5b9b96c.png)

<div dir="rtl">

اگر می خواهید فایل کانفیگ خود را داشته باشید آن را به اسم دیگری ذخیره کنید که هنگام آپدیت اسکریپت تغییر نکند.

#### اجرای اسکریپت 

به محل فایل اسکریپت دانلود شده بروید و سپس اسکریپت را به شکل زیر اجرا کنید

</div>

```
bash cfScanner.sh SUBNET DOWN threads tryCount config.real speed custom.subnets
```


![Screenshot_20230305_101318](https://user-images.githubusercontent.com/125398461/222946688-bcec3d65-7bf1-495a-b1bf-fe517f69f882.png)
<div dir="rtl">
مثلا
</div>

```
bash cfScanner.sh SUBNET DOWN 8 1 config.real 100 custom.subnets
```
<div dir="rtl">

در نهایت نتیجه تست در پوشه result قرار می گیرد که میتوانید آن را ملاحظه کنید و از آن استفاده نمایید. اطلاعات بیشتر در [ویکی](https://github.com/MortezaBashsiz/CFScanner/tree/main/bash) برنامه

### اجرا در نسخه ویندوز

برای نسخه ویندوز نیز پس از دانلود اپ آن را نصب نمایید.

![FqHv_lyXsAAwT95](https://user-images.githubusercontent.com/125398461/222939844-0d312508-d15c-4fe8-b3d9-283e44704339.png)

برای اجرا چند فایل و فولدر مهم هستند که نیاز است آن ها را بشناسیم. تصویر زیر را ملاحظه نمایید.

![FqHzPBqWwAES4vM۲](https://user-images.githubusercontent.com/125398461/222940073-b4263585-8116-4527-84ea-ec6ab22148ae.png)

که محتویات پوشه v2ray-config در اینجا کانفیگ ما برای تست است.

![FqH0986XgAAokev](https://user-images.githubusercontent.com/125398461/222940243-f84e7a8e-45c9-40a8-bc8d-72202ee00fd6.png)

> فایل config.real که اطلاعات اصلی کانفیگ است.

> فایل config.json.template فایل الگوی کانفیگ است.

> در پوشه generated به ازا هر آیپی کلادفلر یک ساختار منطبق با کانفیگ ما ساخته و تست میشه. 

> لازم به ذکر است ساختار این تست بر اساس کانفیگ vmess است اما می توان vless و trojan را نیز با آن تست نمود.

>  بنابراین فایل config.real را بر اساس یک کانفیگ vmess_ws در پنل خود تکمیل کنید.

![FqH3iVjWwAEH7rR](https://user-images.githubusercontent.com/125398461/222940550-a2739cc8-c282-41ea-b193-9374d0ec29ff.png)

در نهایت برای شروع تست می توانید تست همزمان آیپی ها را مشخص کنید و دکمه Start Scan را بزنید.

![FqH5VUGX0AEmXz9](https://user-images.githubusercontent.com/125398461/222940595-8d84cbfb-e391-4762-8da5-c8cd0768579b.png)

در قسمت Fastest IP found سریعترین آیپی موجود بر اساس کمترین میزان تاخیر را نشان می دهد.

توصیه می شود:

* حتما فایل config.real را بر اساس سرور خودتون ادیت کنید. همینطور توصیه می شود
* تعداد همزمانی آیپی را بیشتر از ۸ قرار ندهید تا خروجی دقیق تری بدهد.

بعضی وقت ها ممکنه اپ را باز کنید و اسکن کنید ولی هیچ چیزی نمایش داده نشه؛ در این صورت دو حالت وجود دارد:
> > ۱. آدرس Host  یا SNI مربوط به کانفیگ فیلتر شده.

> > ۲. اطلاعات کانفیگ را به درستی وارد نکردید. برای این مورد باید در پوشه generated یکی از ساختارهایی که قرار داده شده را باز کنید و چک کنید آیا اطلاعات این ساختار با کانفیگ شما یکی هست یا نه.

![FqH7-nxXgAEc3lR](https://user-images.githubusercontent.com/125398461/222940830-906481cb-f8dc-4e3a-abf9-61528f844435.png)


## بعد از یافتن آیپی تمیز چکار کنیم؟

پس از یافتن آیپی تمیز؛ می توانید آن را با یک رکورد dns بدون پروکسی ثبت نمایید. یعنی در سایت کلادفلر یک ساب دامین بسازید. پروکسی را خاموش کنید و آیپی را وارد کنید.

![Screenshot_20230302_171704](https://user-images.githubusercontent.com/125398461/222942018-f53bf1bd-77c4-45b5-9604-0224061869d0.png)
در صورت نیاز به توضیحات بیشتر درباره دامنه [اینجا](https://github.com/hiddify/hiddify-config/wiki/%D8%A7%D9%86%D9%88%D8%A7%D8%B9-%D8%AF%D8%A7%D9%85%D9%86%D9%87-%D9%88-%D9%86%D8%AD%D9%88%D9%87-%D8%AB%D8%A8%D8%AA-%E2%80%8C%D8%A2%D9%86%E2%80%8C%D9%87%D8%A7) کلیک کنید.

سپس در پنل هیدیفای می توانید آن را در تنظیمات دامنه CDN در فیلد **اجبار به استفاده از هاست در کانفیگ CDN**  قرار دهید. [توضیحات بیشتر](https://github.com/hiddify/hiddify-config/wiki/%D9%86%D8%AD%D9%88%D9%87-%D9%BE%DB%8C%DA%A9%D8%B1%D8%A8%D9%86%D8%AF%DB%8C-%D9%BE%D9%86%D9%84-%D9%87%DB%8C%D8%AF%DB%8C%D9%81%D8%A7%DB%8C#%D8%AF%D8%A7%D9%85%D9%86%D9%87-cdn)

![Screenshot_20230301_095103](https://user-images.githubusercontent.com/125398461/222942200-ce36835f-41d9-4bc9-abf5-a4c35c34d33f.png)



